<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatHub - Cloudflareå®æ—¶èŠå¤©</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’¬</text></svg>">
    
    <!-- ç¡®ä¿CSSå˜é‡åœ¨åŠ è½½æ—¶å®šä¹‰ -->
    <style>
        :root {
            --primary-color: #5865F2;
            --secondary-color: #57F287;
            --background-color: #36393F;
            --surface-color: #2F3136;
            --surface-light: #3A3D43;
            --text-primary: #FFFFFF;
            --text-secondary: #B9BBBE;
            --text-muted: #72767D;
            --border-color: #202225;
            --success-color: #3BA55C;
            --warning-color: #FAA61A;
            --danger-color: #ED4245;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.2);
        }
        
        body {
            background: var(--background-color) !important;
            color: var(--text-primary) !important;
        }
    </style>
</head>
<body>
    <!-- è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div id="connectionIndicator" class="connection-indicator disconnected">
        <span id="connectionStatus">ğŸ”´ æœªè¿æ¥</span>
    </div>

    <!-- ç™»å½•ç•Œé¢ -->
    <div id="loginScreen" class="screen">
        <div class="login-container">
            <div class="login-card">
                <div class="logo">
                    <h1>ğŸ’¬ ChatHub</h1>
                    <p>åŸºäºCloudflare Workersçš„å®æ—¶èŠå¤©å¹³å°</p>
                    <div class="version-badge">v1.0.0</div>
                </div>
                
                <form id="loginForm" class="login-form">
                    <div class="form-group">
                        <label for="username">ç”¨æˆ·å</label>
                        <input type="text" id="username" name="username" required maxlength="20" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                    </div>
                    
                    <div class="form-group">
                        <label for="room">æˆ¿é—´</label>
                        <select id="room" name="room">
                            <option value="general">ç»¼åˆè®¨è®º</option>
                            <option value="tech">æŠ€æœ¯äº¤æµ</option>
                            <option value="random">éšæœºèŠå¤©</option>
                            <option value="gaming">æ¸¸æˆè®¨è®º</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>é€‰æ‹©å¤´åƒ</label>
                        <div class="avatar-grid">
                            <div class="avatar-option selected" data-avatar="ğŸ˜€">ğŸ˜€</div>
                            <div class="avatar-option" data-avatar="ğŸ®">ğŸ®</div>
                            <div class="avatar-option" data-avatar="ğŸš€">ğŸš€</div>
                            <div class="avatar-option" data-avatar="ğŸ’">ğŸ’</div>
                            <div class="avatar-option" data-avatar="ğŸ”¥">ğŸ”¥</div>
                            <div class="avatar-option" data-avatar="â­">â­</div>
                        </div>
                    </div>
                    
                    <button type="submit" class="login-btn" id="loginBtn">
                        <span class="btn-text">è¿›å…¥èŠå¤©å®¤</span>
                        <span class="btn-loading" style="display: none;">è¿æ¥ä¸­...</span>
                    </button>
                </form>
                
                <div class="login-footer">
                    <p>å½“å‰åœ¨çº¿: <span id="onlineCount">-</span> äºº</p>
                    <p>æœåŠ¡å™¨çŠ¶æ€: <span id="serverStatus">æ£€æŸ¥ä¸­...</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- èŠå¤©ç•Œé¢ -->
    <div id="chatScreen" class="screen hidden">
        <div class="chat-container">
            <!-- ä¾§è¾¹æ  -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar">ğŸ˜€</div>
                        <div class="user-details">
                            <div class="username" id="displayUsername">ç”¨æˆ·</div>
                            <div class="current-room" id="currentRoom">ç»¼åˆè®¨è®º</div>
                            <div class="connection-status" id="wsStatus">ğŸŸ¢ å·²è¿æ¥</div>
                        </div>
                        <button class="logout-btn" onclick="logout()">é€€å‡º</button>
                    </div>
                </div>
                
                <div class="room-list">
                    <h3>æˆ¿é—´åˆ—è¡¨</h3>
                    <div class="room-item active" data-room="general">
                        <span class="room-icon">#</span>
                        <span class="room-name">ç»¼åˆè®¨è®º</span>
                        <span class="room-count" data-room-count="general">0</span>
                    </div>
                    <div class="room-item" data-room="tech">
                        <span class="room-icon">#</span>
                        <span class="room-name">æŠ€æœ¯äº¤æµ</span>
                        <span class="room-count" data-room-count="tech">0</span>
                    </div>
                    <div class="room-item" data-room="random">
                        <span class="room-icon">#</span>
                        <span class="room-name">éšæœºèŠå¤©</span>
                        <span class="room-count" data-room-count="random">0</span>
                    </div>
                    <div class="room-item" data-room="gaming">
                        <span class="room-icon">#</span>
                        <span class="room-name">æ¸¸æˆè®¨è®º</span>
                        <span class="room-count" data-room-count="gaming">0</span>
                    </div>
                    <div class="room-item" data-room="xin">
                        <span class="room-icon">#</span>
                        <span class="room-name">ä½ çœŸâ€œåˆ‘â€</span>
                        <span class="room-count" data-room-count="xin">0</span>
                    </div>
                </div>
                
                <div class="online-users">
                    <h3>åœ¨çº¿ç”¨æˆ·</h3>
                    <div id="usersList"></div>
                </div>
            </aside>

            <!-- ä¸»èŠå¤©åŒºåŸŸ -->
            <main class="chat-main">
                <header class="chat-header">
                    <div class="header-info">
                        <h2 id="roomTitle"># ç»¼åˆè®¨è®º</h2>
                        <p id="roomDescription">åŸºäºCloudflare Workersçš„å®æ—¶èŠå¤©</p>
                    </div>
                    <div class="header-actions">
                        <button class="action-btn" onclick="toggleEmojiPicker()">ğŸ˜Š</button>
                        <button class="action-btn" onclick="toggleUserList()">ğŸ‘¥</button>
                        <button class="action-btn" onclick="checkConnection()">ğŸ”„</button>
                    </div>
                </header>

                <div class="messages-container" id="messagesContainer">
                    <div class="welcome-message">
                        <h3>æ¬¢è¿æ¥åˆ° ChatHub</h3>
                        <p>åŸºäºCloudflare Workersçš„å®æ—¶èŠå¤©å¹³å°</p>
                        <p>è¿æ¥çŠ¶æ€: <span id="welcomeStatus">è¿æ¥ä¸­...</span></p>
                    </div>
                </div>

                <div class="input-container">
                    <div class="input-wrapper">
                        <button class="input-btn" onclick="toggleEmojiPicker()">ğŸ˜Š</button>
                        <textarea 
                            id="messageInput" 
                            placeholder="è¾“å…¥æ¶ˆæ¯..."
                            rows="1"
                            maxlength="500"
                        ></textarea>
                        <button id="sendBtn" class="send-btn" onclick="sendMessage()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="emoji-picker" id="emojiPicker">
                        <!-- è¡¨æƒ…ç¬¦å·å°†é€šè¿‡JSç”Ÿæˆ -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
